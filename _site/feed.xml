<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2025-06-17T13:29:54+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Earth_zZ</title><subtitle>åˆå­¦è€…çš„åšå®¢</subtitle><entry><title type="html">è¯­éŸ³è¯†åˆ«</title><link href="http://localhost:4000/2025/05/13/my-two.html" rel="alternate" type="text/html" title="è¯­éŸ³è¯†åˆ«" /><published>2025-05-13T00:00:00+08:00</published><updated>2025-05-13T00:00:00+08:00</updated><id>http://localhost:4000/2025/05/13/my-two</id><content type="html" xml:base="http://localhost:4000/2025/05/13/my-two.html"><![CDATA[<p>é€šè¿‡è…¾è®¯äº‘SDKå®ç°è¯­éŸ³è¯†åˆ«åŠŸèƒ½ï¼Œæ”¯æŒæµå¼è¾“å‡ºå’Œå®¢æˆ·ç«¯éº¦å…‹é£è°ƒç”¨ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„å®ç°æµç¨‹ï¼š</p>

<h2 id="ä¸€å‡†å¤‡ç¯å¢ƒ">ä¸€ã€å‡†å¤‡ç¯å¢ƒ</h2>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒå·²ç»å®‰è£…ï¼š</span>
<span class="err">1.Python</span> <span class="err">3.6+</span>
<span class="err">2.è…¾è®¯äº‘SDK</span>
<span class="err">3.PyAudioï¼ˆç”¨äºéº¦å…‹é£å½•éŸ³ï¼‰</span>
<span class="err">4.è…¾è®¯äº‘è´¦å·å’ŒAPIå¯†é’¥</span>
</code></pre></div></div>

<p>å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>tencentcloud-sdk-python
pip <span class="nb">install </span>pyaudio
pip <span class="nb">install </span>websocket-client
</code></pre></div></div>

<h2 id="äºŒè·å–è…¾è®¯äº‘apiå¯†é’¥">äºŒã€è·å–è…¾è®¯äº‘APIå¯†é’¥</h2>

<p>ç™»å½•è…¾è®¯äº‘æ§åˆ¶å°ï¼Œè·å–ä»¥ä¸‹ä¿¡æ¯ï¼š</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">1.SecretId</span>
<span class="err">2.SecretKey</span>
<span class="err">3.AppIdï¼ˆè¯­éŸ³è¯†åˆ«åº”ç”¨IDï¼‰</span>
</code></pre></div></div>

<p>åœ¨è…¾è®¯äº‘æ§åˆ¶å° &gt; è®¿é—®ç®¡ç† &gt; APIå¯†é’¥ç®¡ç†ä¸­åˆ›å»ºå¯†é’¥ã€‚</p>

<h2 id="ä¸‰é…ç½®ç¯å¢ƒå˜é‡">ä¸‰ã€é…ç½®ç¯å¢ƒå˜é‡</h2>

<p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå»ºè®®å°†å¯†é’¥ä¿¡æ¯é…ç½®ä¸ºç¯å¢ƒå˜é‡ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Windows</span>
<span class="nb">set </span><span class="nv">TENCENT_SECRET_ID</span><span class="o">=</span>your_secret_id
<span class="nb">set </span><span class="nv">TENCENT_SECRET_KEY</span><span class="o">=</span>your_secret_key
<span class="nb">set </span><span class="nv">TENCENT_APP_ID</span><span class="o">=</span>your_app_id

<span class="c"># Linux/Mac</span>
<span class="nb">export </span><span class="nv">TENCENT_SECRET_ID</span><span class="o">=</span>your_secret_id
<span class="nb">export </span><span class="nv">TENCENT_SECRET_KEY</span><span class="o">=</span>your_secret_key
<span class="nb">export </span><span class="nv">TENCENT_APP_ID</span><span class="o">=</span>your_app_id
</code></pre></div></div>

<h2 id="å››å®ç°è¯­éŸ³è¯†åˆ«ä»£ç ">å››ã€å®ç°è¯­éŸ³è¯†åˆ«ä»£ç </h2>

<h3 id="41-åŸºç¡€é…ç½®">4.1 åŸºç¡€é…ç½®</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">pyaudio</span>
<span class="kn">import</span> <span class="n">threading</span>
<span class="kn">from</span> <span class="n">tencentcloud.common</span> <span class="kn">import</span> <span class="n">credential</span>
<span class="kn">from</span> <span class="n">tencentcloud.common.profile.client_profile</span> <span class="kn">import</span> <span class="n">ClientProfile</span>
<span class="kn">from</span> <span class="n">tencentcloud.common.profile.http_profile</span> <span class="kn">import</span> <span class="n">HttpProfile</span>
<span class="kn">from</span> <span class="n">tencentcloud.asr.v20190614</span> <span class="kn">import</span> <span class="n">asr_client</span><span class="p">,</span> <span class="n">models</span>

<span class="c1"># é…ç½®ä¿¡æ¯
</span><span class="n">SECRET_ID</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">TENCENT_SECRET_ID</span><span class="sh">'</span><span class="p">)</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">TENCENT_SECRET_KEY</span><span class="sh">'</span><span class="p">)</span>
<span class="n">APP_ID</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">'</span><span class="s">TENCENT_APP_ID</span><span class="sh">'</span><span class="p">)</span>
<span class="n">REGION</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ap-beijing</span><span class="sh">"</span>  <span class="c1"># æ ¹æ®éœ€è¦é€‰æ‹©åœ°åŸŸ
</span>
<span class="c1"># éŸ³é¢‘å‚æ•°
</span><span class="n">CHUNK</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">FORMAT</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="p">.</span><span class="n">paInt16</span>
<span class="n">CHANNELS</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">RATE</span> <span class="o">=</span> <span class="mi">16000</span>
</code></pre></div></div>

<h3 id="42-å®æ—¶è¯­éŸ³è¯†åˆ«ç±»">4.2 å®æ—¶è¯­éŸ³è¯†åˆ«ç±»</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RealTimeASR</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cred</span> <span class="o">=</span> <span class="n">credential</span><span class="p">.</span><span class="nc">Credential</span><span class="p">(</span><span class="n">SECRET_ID</span><span class="p">,</span> <span class="n">SECRET_KEY</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">httpProfile</span> <span class="o">=</span> <span class="nc">HttpProfile</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">httpProfile</span><span class="p">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="sh">"</span><span class="s">asr.tencentcloudapi.com</span><span class="sh">"</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">clientProfile</span> <span class="o">=</span> <span class="nc">ClientProfile</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">clientProfile</span><span class="p">.</span><span class="n">httpProfile</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">httpProfile</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">asr_client</span><span class="p">.</span><span class="nc">AsrClient</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">cred</span><span class="p">,</span> <span class="n">REGION</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">clientProfile</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">audio</span> <span class="o">=</span> <span class="n">pyaudio</span><span class="p">.</span><span class="nc">PyAudio</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stream</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">is_recording</span> <span class="o">=</span> <span class="bp">False</span>
        
    <span class="k">def</span> <span class="nf">start_recording</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">å¼€å§‹å½•éŸ³</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">audio</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span>
            <span class="nb">format</span><span class="o">=</span><span class="n">FORMAT</span><span class="p">,</span>
            <span class="n">channels</span><span class="o">=</span><span class="n">CHANNELS</span><span class="p">,</span>
            <span class="n">rate</span><span class="o">=</span><span class="n">RATE</span><span class="p">,</span>
            <span class="nb">input</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">frames_per_buffer</span><span class="o">=</span><span class="n">CHUNK</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">is_recording</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">å¼€å§‹å½•éŸ³...</span><span class="sh">"</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">stop_recording</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">åœæ­¢å½•éŸ³</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">is_recording</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="nf">stop_stream</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">å½•éŸ³ç»“æŸ</span><span class="sh">"</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">recognize_stream</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">æµå¼è¯­éŸ³è¯†åˆ«</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">è¯·å…ˆå¼€å§‹å½•éŸ³</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>
            
        <span class="n">audio_data</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">while</span> <span class="n">self</span><span class="p">.</span><span class="n">is_recording</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">stream</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">CHUNK</span><span class="p">,</span> <span class="n">exception_on_overflow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">audio_data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                
                <span class="c1"># æ¯æ”¶é›†ä¸€å®šé‡çš„éŸ³é¢‘æ•°æ®å°±è¿›è¡Œä¸€æ¬¡è¯†åˆ«
</span>                <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">audio_data</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># çº¦0.64ç§’çš„éŸ³é¢‘
</span>                    <span class="n">audio_bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">audio_data</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_recognize_audio</span><span class="p">(</span><span class="n">audio_bytes</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">callback</span><span class="p">:</span>
                        <span class="nf">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    
                    <span class="n">audio_data</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># æ¸…ç©ºç¼“å­˜
</span>                    
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">å½•éŸ³é”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">break</span>
                
    <span class="k">def</span> <span class="nf">_recognize_audio</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">audio_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">è°ƒç”¨è…¾è®¯äº‘APIè¿›è¡Œè¯­éŸ³è¯†åˆ«</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="nc">CreateRecTaskRequest</span><span class="p">()</span>
            <span class="n">req</span><span class="p">.</span><span class="n">EngineModelType</span> <span class="o">=</span> <span class="sh">"</span><span class="s">16k_zh</span><span class="sh">"</span>  <span class="c1"># ä¸­æ–‡æ™®é€šè¯
</span>            <span class="n">req</span><span class="p">.</span><span class="n">ChannelNum</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">req</span><span class="p">.</span><span class="n">ResTextFormat</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">req</span><span class="p">.</span><span class="n">SourceType</span> <span class="o">=</span> <span class="mi">1</span>
            
            <span class="c1"># å°†éŸ³é¢‘æ•°æ®è½¬æ¢ä¸ºbase64
</span>            <span class="kn">import</span> <span class="n">base64</span>
            <span class="n">audio_base64</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">audio_data</span><span class="p">).</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">req</span><span class="p">.</span><span class="n">Data</span> <span class="o">=</span> <span class="n">audio_base64</span>
            
            <span class="n">resp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="nc">CreateRecTask</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
            
            <span class="c1"># è·å–ä»»åŠ¡ID
</span>            <span class="n">task_id</span> <span class="o">=</span> <span class="n">resp</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">TaskId</span>
            
            <span class="c1"># è½®è¯¢è·å–ç»“æœ
</span>            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_recognition_result</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">è¯†åˆ«é”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
            
    <span class="k">def</span> <span class="nf">_get_recognition_result</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">è·å–è¯†åˆ«ç»“æœ</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="nc">DescribeTaskStatusRequest</span><span class="p">()</span>
            <span class="n">req</span><span class="p">.</span><span class="n">TaskId</span> <span class="o">=</span> <span class="n">task_id</span>
            
            <span class="c1"># è½®è¯¢ç­‰å¾…ç»“æœ
</span>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>  <span class="c1"># æœ€å¤šç­‰å¾…30ç§’
</span>                <span class="n">resp</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="nc">DescribeTaskStatus</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">resp</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">StatusStr</span> <span class="o">==</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">resp</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">Result</span>
                <span class="k">elif</span> <span class="n">resp</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">StatusStr</span> <span class="o">==</span> <span class="sh">"</span><span class="s">failed</span><span class="sh">"</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">è¯†åˆ«å¤±è´¥</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">None</span>
                    
                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ç­‰å¾…1ç§’åé‡è¯•
</span>                
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">è¯†åˆ«è¶…æ—¶</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">è·å–ç»“æœé”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h2 id="äº”ä½¿ç”¨ç¤ºä¾‹">äº”ã€ä½¿ç”¨ç¤ºä¾‹</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">on_recognition_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">è¯†åˆ«ç»“æœå›è°ƒå‡½æ•°</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">è¯†åˆ«ç»“æœ: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># åˆ›å»ºè¯­éŸ³è¯†åˆ«å®ä¾‹
</span>    <span class="n">asr</span> <span class="o">=</span> <span class="nc">RealTimeASR</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># å¼€å§‹å½•éŸ³
</span>        <span class="n">asr</span><span class="p">.</span><span class="nf">start_recording</span><span class="p">()</span>
        
        <span class="c1"># åˆ›å»ºè¯†åˆ«çº¿ç¨‹
</span>        <span class="n">recognition_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">asr</span><span class="p">.</span><span class="n">recognize_stream</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">on_recognition_result</span><span class="p">,)</span>
        <span class="p">)</span>
        <span class="n">recognition_thread</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
        
        <span class="c1"># ç­‰å¾…ç”¨æˆ·è¾“å…¥åœæ­¢
</span>        <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">æŒ‰å›è½¦é”®åœæ­¢å½•éŸ³...</span><span class="sh">"</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">ç”¨æˆ·ä¸­æ–­</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># åœæ­¢å½•éŸ³
</span>        <span class="n">asr</span><span class="p">.</span><span class="nf">stop_recording</span><span class="p">()</span>
        
        <span class="c1"># ç­‰å¾…è¯†åˆ«çº¿ç¨‹ç»“æŸ
</span>        <span class="k">if</span> <span class="sh">'</span><span class="s">recognition_thread</span><span class="sh">'</span> <span class="ow">in</span> <span class="nf">locals</span><span class="p">():</span>
            <span class="n">recognition_thread</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
            
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="å…­ä¼˜åŒ–å»ºè®®">å…­ã€ä¼˜åŒ–å»ºè®®</h2>

<h3 id="61-é”™è¯¯å¤„ç†">6.1 é”™è¯¯å¤„ç†</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># æ·»åŠ æ›´å®Œå–„çš„é”™è¯¯å¤„ç†
</span><span class="k">try</span><span class="p">:</span>
    <span class="c1"># è¯­éŸ³è¯†åˆ«ä»£ç 
</span>    <span class="k">pass</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">å‘ç”Ÿé”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># è®°å½•æ—¥å¿—æˆ–è¿›è¡Œå…¶ä»–å¤„ç†
</span></code></pre></div></div>

<h3 id="62-æ€§èƒ½ä¼˜åŒ–">6.2 æ€§èƒ½ä¼˜åŒ–</h3>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">1.è°ƒæ•´éŸ³é¢‘ç¼“å­˜å¤§å°ï¼Œå¹³è¡¡å®æ—¶æ€§å’Œå‡†ç¡®æ€§</span>
<span class="err">2.ä½¿ç”¨å¼‚æ­¥å¤„ç†æé«˜å“åº”é€Ÿåº¦</span>
<span class="err">3.æ·»åŠ éŸ³é¢‘è´¨é‡æ£€æµ‹ï¼Œè¿‡æ»¤å™ªéŸ³</span>
<span class="err">4.å®ç°æ–­çº¿é‡è¿æœºåˆ¶</span>
</code></pre></div></div>

<h3 id="63-åŠŸèƒ½æ‰©å±•">6.3 åŠŸèƒ½æ‰©å±•</h3>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">1.æ”¯æŒå¤šè¯­è¨€è¯†åˆ«</span>
<span class="err">2.æ·»åŠ è¯­éŸ³ç«¯ç‚¹æ£€æµ‹</span>
<span class="err">3.å®ç°è¯­éŸ³è½¬æ–‡å­—çš„å®æ—¶æ˜¾ç¤º</span>
<span class="err">4.æ”¯æŒéŸ³é¢‘æ–‡ä»¶æ‰¹é‡å¤„ç†</span>
</code></pre></div></div>

<h2 id="ä¸ƒæ³¨æ„äº‹é¡¹">ä¸ƒã€æ³¨æ„äº‹é¡¹</h2>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">1.ç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®šï¼Œè¯­éŸ³è¯†åˆ«éœ€è¦å®æ—¶ç½‘ç»œè¯·æ±‚</span>
<span class="err">2.æ³¨æ„APIè°ƒç”¨é¢‘ç‡é™åˆ¶ï¼Œé¿å…è¶…å‡ºé…é¢</span>
<span class="err">3.éŸ³é¢‘è´¨é‡ä¼šç›´æ¥å½±å“è¯†åˆ«å‡†ç¡®ç‡</span>
<span class="err">4.å¦¥å–„ä¿ç®¡APIå¯†é’¥ï¼Œé¿å…æ³„éœ²</span>
<span class="err">5.æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„è¯†åˆ«å¼•æ“æ¨¡å‹</span>
</code></pre></div></div>

<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å°±å¯ä»¥æˆåŠŸå®ç°åŸºäºè…¾è®¯äº‘SDKçš„å®æ—¶è¯­éŸ³è¯†åˆ«åŠŸèƒ½äº†ï¼</p>

<p>å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æŸ¥çœ‹è…¾è®¯äº‘å®˜æ–¹æ–‡æ¡£æˆ–è€…åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµã€‚</p>]]></content><author><name></name></author><summary type="html"><![CDATA[é€šè¿‡è…¾è®¯äº‘SDKå®ç°è¯­éŸ³è¯†åˆ«åŠŸèƒ½ï¼Œæ”¯æŒæµå¼è¾“å‡ºå’Œå®¢æˆ·ç«¯éº¦å…‹é£è°ƒç”¨ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„å®ç°æµç¨‹ï¼š]]></summary></entry><entry><title type="html">å¦‚ä½•åœ¨æœ¬åœ°éƒ¨ç½²DiFy</title><link href="http://localhost:4000/2025/04/30/my-one.html" rel="alternate" type="text/html" title="å¦‚ä½•åœ¨æœ¬åœ°éƒ¨ç½²DiFy" /><published>2025-04-30T00:00:00+08:00</published><updated>2025-04-30T00:00:00+08:00</updated><id>http://localhost:4000/2025/04/30/my-one</id><content type="html" xml:base="http://localhost:4000/2025/04/30/my-one.html"><![CDATA[<p>åœ¨æœ¬åœ°éƒ¨ç½²DiFyå¯ä»¥é€šè¿‡Dockerå¿«æ·æ­å»ºï¼Œä»¥ä¸‹æ˜¯éƒ¨ç½²æµç¨‹ï¼š</p>

<h2 id="ä¸€å‡†å¤‡ç¯å¢ƒ">ä¸€ã€å‡†å¤‡ç¯å¢ƒ</h2>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">ç¡®ä¿ä½ çš„æœ¬åœ°å·²ç»å®‰è£…ï¼š</span>
<span class="err">1.Docker</span>
<span class="err">2.Docker</span> <span class="err">Compose</span>
<span class="err">3.Git</span>
</code></pre></div></div>

<p>å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nt">-v</span>
docker compose version
git <span class="nt">--version</span>
</code></pre></div></div>

<h2 id="äºŒæ‹‰å–difyæºç ">äºŒã€æ‹‰å–DiFyæºç </h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/langgenius/dify.git
<span class="nb">cd </span>dify/docker
</code></pre></div></div>

<h2 id="ä¸‰é…ç½®ç¯å¢ƒå˜é‡">ä¸‰ã€é…ç½®ç¯å¢ƒå˜é‡</h2>

<p>åœ¨æ ¹ç›®å½•ä¸‹å¤åˆ¶ <code class="language-plaintext highlighter-rouge">.env.example</code> ä¸º <code class="language-plaintext highlighter-rouge">.env</code>ï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># macæˆ–è€…Linux</span>
<span class="nb">cp</span> .env.example .env
<span class="c"># windows</span>
copy .env.example .env
</code></pre></div></div>

<h2 id="å››ä½¿ç”¨-docker-compose-å¯åŠ¨æœåŠ¡">å››ã€ä½¿ç”¨ Docker Compose å¯åŠ¨æœåŠ¡</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker compose up <span class="nt">-d</span>
</code></pre></div></div>

<p>è¿™ä¼šå¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š</p>

<ul>
  <li>Web åº”ç”¨å‰ç«¯ï¼ˆ<code class="language-plaintext highlighter-rouge">web</code>ï¼‰</li>
  <li>åç«¯æœåŠ¡ï¼ˆ<code class="language-plaintext highlighter-rouge">api</code>ï¼‰</li>
  <li>å‘é‡æ•°æ®åº“ï¼ˆé»˜è®¤æ˜¯ <code class="language-plaintext highlighter-rouge">qdrant</code>ï¼‰</li>
  <li>Redis</li>
  <li>PostgreSQL</li>
</ul>

<h2 id="äº”è®¿é—®æœ¬åœ°æœåŠ¡">äº”ã€è®¿é—®æœ¬åœ°æœåŠ¡</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://localhost:3000
</code></pre></div></div>

<p>é»˜è®¤è®¿é—®åœ°å€ï¼Œå¦‚æœä¸æ­£ç¡®çš„è¯ï¼Œåœ¨<code class="language-plaintext highlighter-rouge">dify/docker</code>ä¸­æœ‰ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">docker-compose.yml</code>æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶æŸ¥çœ‹ç«¯å£ã€‚</p>

<h2 id="å…­è®¾ç½®å…¬ç½‘åœ°å€å¯é€‰">å…­ã€è®¾ç½®å…¬ç½‘åœ°å€ï¼ˆå¯é€‰ï¼‰</h2>

<p>åˆ©ç”¨<code class="language-plaintext highlighter-rouge">ngrok</code>å¯ä»¥å°†<code class="language-plaintext highlighter-rouge">dify</code>åœ¨å…¬ç½‘å…¬å¼€ï¼Œå¦åˆ™çš„è¯ï¼Œåªèƒ½æœ¬åœ°è¿æ¥ã€‚</p>

<p>ä½†æ˜¯<code class="language-plaintext highlighter-rouge">ngrok</code>æ¯æ¬¡å¯åŠ¨ä¸€æ¬¡ï¼Œç½‘å€å°±ä¼šå˜ï¼Œ<strong>åªå»ºè®®ä¸´æ—¶ä½¿ç”¨</strong>ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># å¦‚æœdifyåœ¨ä½ ç”µè„‘çš„ç«¯å£æ˜¯80</span>
ngrok http 80
</code></pre></div></div>

<p>è¿™æ ·ä½ å°±ä¼šå¾—åˆ°ä¸€ä¸ªå¯ä»¥å…è®¸ä»»ä½•ç½‘ç»œè¿æ¥çš„ç½‘å€ã€‚</p>]]></content><author><name></name></author><summary type="html"><![CDATA[åœ¨æœ¬åœ°éƒ¨ç½²DiFyå¯ä»¥é€šè¿‡Dockerå¿«æ·æ­å»ºï¼Œä»¥ä¸‹æ˜¯éƒ¨ç½²æµç¨‹ï¼š]]></summary></entry><entry><title type="html">æ¢¦å¼€å§‹çš„åœ°æ–¹</title><link href="http://localhost:4000/2025/04/22/my-first.html" rel="alternate" type="text/html" title="æ¢¦å¼€å§‹çš„åœ°æ–¹" /><published>2025-04-22T00:00:00+08:00</published><updated>2025-04-22T00:00:00+08:00</updated><id>http://localhost:4000/2025/04/22/my-first</id><content type="html" xml:base="http://localhost:4000/2025/04/22/my-first.html"><![CDATA[<h2 id="æ¬¢è¿">æ¬¢è¿</h2>

<p>æ¬¢è¿è®¿é—®æˆ‘çš„åšå®¢<br /></p>

<p>æ¢¦å¼€å§‹çš„åœ°æ–¹ ğŸŒ™  <br />
æ¬¢è¿ä½ æ¥åˆ°æˆ‘çš„åšå®¢ï¼<br /></p>

<p>è¿™æ˜¯æˆ‘åœ¨ GitHub ä¸Šæ­å»ºçš„ç¬¬ä¸€ä¸ªåšå®¢ï¼Œä¸€ä¸ªå±äºæˆ‘è‡ªå·±çš„å°è§’è½ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæˆ‘è®°å½•æ€è€ƒã€åˆ†äº«ç”Ÿæ´»ã€äº¤æµæƒ³æ³•çš„åœ°æ–¹ã€‚<br /></p>

<p>â€œæ¢¦å¼€å§‹çš„åœ°æ–¹â€ï¼Œè¿™ä¸ªæ ‡é¢˜ä¸åªæ˜¯å†™ç»™è‡ªå·±ï¼Œä¹Ÿæ˜¯å†™ç»™æ¯ä¸€ä¸ªæ„¿æ„åœä¸‹æ¥çœ‹ä¸€çœ‹çš„ä½ ã€‚<br />
åœ¨è¿™é‡Œï¼Œæˆ‘ä¼šåˆ†äº«æˆ‘æ­£åœ¨å­¦çš„ã€æ­£åœ¨åšçš„ã€æ­£åœ¨æƒ³çš„ï¼š<br />
æ— è®ºæ˜¯ä»£ç ã€æŠ€æœ¯ã€äº§å“è®¾è®¡ï¼Œè¿˜æ˜¯ç”Ÿæ´»ä¸­çš„å°ç¡®å¹¸ã€åˆå¤œçš„çµæ„Ÿç¢ç‰‡ã€‚<br /></p>

<p>å½“ç„¶ï¼Œä¹Ÿä¼šæ—¶ä¸æ—¶å¤¹å¸¦ä¸€ç‚¹å°å°çš„ç§è´§ï½<br />
æ¯”å¦‚æˆ‘å¾ˆå–œæ¬¢çš„å¶åƒ ä½³ä½³å­_zZï¼Œå¥¹ç”¨å¥¹çš„çœŸè¯šä¸å–„è‰¯ï¼Œå¸¦ç»™æˆ‘å¾ˆå¤šçµæ„Ÿå’Œå¿«ä¹ï¼›<br />
å¤§å®¶å¦‚æœæƒ³è¦äº†è§£å¥¹ï¼Œå¯ä»¥å»ä½³äººåˆ¶ä½œçš„ijiaå­¦é™¢ï¼Œé‚£é‡Œæœ‰å¥¹çš„è¶³è¿¹ï¼ˆijiazz.cnï¼‰;<br />
å¦‚æœä½ ä¹Ÿæ„Ÿå…´è¶£ï¼Œæ¬¢è¿ä¸€èµ·åˆ°â€œijiaå­¦é™¢â€å­¦ä¹ ï¼<br /></p>

<p>å¸Œæœ›å®ƒä¸ä»…ä»…æ˜¯æˆ‘çš„æ¢¦å¼€å§‹çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥æˆä¸ºä½ çµæ„Ÿé—ªç°ã€æƒ³æ³•ç¢°æ’çš„èµ·ç‚¹ã€‚<br /></p>

<p>å¦‚æœä½ æ„¿æ„ï¼Œæ¬¢è¿ä½ ç•™è¨€ã€äº¤æµï¼Œç”šè‡³åŠ å…¥è¿™ä¸ªæ¢¦æƒ³çš„æ—…ç¨‹ã€‚<br /></p>]]></content><author><name></name></author><summary type="html"><![CDATA[æ¬¢è¿]]></summary></entry></feed>